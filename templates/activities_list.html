{% extends "base.html" %}
{% block content %}
  <h2>Atividades</h2>
  <p><a href="{{ url_for('activities_add') }}">Adicionar atividade</a></p>
  {% if activities %}
    <div>
      {% for a in activities %}
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
            <div>
              <strong style="font-size:1.03rem">{{ a['name'] }}</strong>
              {% if a.percent is not none %}
                <div style="font-size:0.9rem; color:var(--accent);">Meta: {{ a.goal_points }} • {{ a.percent }}%</div>
                <div style="margin-top:6px;">
                  <div class="progress {% if a.percent >= 100 %}complete{% endif %}" title="{{ a.completed }} / {{ a.goal_points or 0 }} pontos">
                    <div class="bar" style="width:{{ a.percent }}%"></div>
                    <div class="label" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); font-size:0.85rem; font-weight:700; color:{% if a.percent >=50 %}#fff{% else %}#0b1220{% endif %};">{{ a.percent }}%</div>
                  </div>
                </div>
              {% elif a.goal_points %}
                <div style="font-size:0.9rem; color:var(--muted);">Meta: {{ a.goal_points }} • 0%</div>
                <div style="margin-top:6px;">
                  <div class="progress" title="0 / {{ a.goal_points or 0 }} pontos"><div class="bar" style="width:0%"></div><div class="label" style="position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); font-size:0.85rem; font-weight:700; color:#0b1220;">0%</div></div>
                </div>
              {% endif %}
              <div style="color:var(--muted); font-size:0.9rem">{% if a['date'] %}{{ a['date'] }} • {% endif %}{{ a['created_at'] }}</div>
            </div>
            <div class="actions">
              <a class="btn btn-outline" href="{{ url_for('activities_show', id=a['id']) }}"><i class="fa fa-eye small-icon"></i> Ver</a>
              <a class="btn btn-outline" href="{{ url_for('activities_edit', id=a['id']) }}"><i class="fa fa-edit small-icon"></i> Editar</a>
              <form method="post" action="{{ url_for('activities_delete', id=a['id']) }}" style="display:inline;">
                <button class="btn btn-danger" type="submit" onclick="return confirm('Excluir atividade?')"><i class="fa fa-trash small-icon"></i>Excluir</button>
              </form>
            </div>
          </div>
          <div style="margin-top:8px; color:#111827">{{ a['description'] }}</div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p>Nenhuma atividade registrada.</p>
  {% endif %}
{% endblock %}
